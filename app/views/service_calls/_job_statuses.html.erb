<ul class="unstyled" id="block_job_statuses_actions">

  <li>
    <div class="smart_label statuses">
      <ul>
        <li><h1><%= I18n.t('general.general.job_statuses').html_safe %></h1>
        <li class="job_icons">
          <% if @service_call.class == MyServiceCall %>
              <% if @service_call.transferred? %>
                  <%= image_tag("Itransferred.png", :title => I18n.t('general.messages.transferred_job').html_safe, :rel => 'tooltip') %>
              <% end %>
              <%= image_tag("myJobLarge.png", :title => I18n.t('general.messages.myJob').html_safe, :rel => 'tooltip') %>
          <% else %>
              <%= image_tag("Incoming.png", :title => I18n.t('general.messages.incoming_job').html_safe, :rel => 'tooltip') %>
          <% end %>

        </li>
      </ul>
    </div>
  </li>
  <li>

    <table class="table table-striped table-condensed table-sbcx">
      <tbody>
      <tr>
        <td><strong> <%= @service_call.class.human_attribute_name(:status) %></strong></td>
        <td>
          <span class="<%= style("service_call.states.status.#{@service_call.status_name}") %>" id="service_call_status">
          <h3><%= @service_call.human_status_name %></h3>
          </span>
        </td>
      </tr>
      <tr>
        <td><strong> <%= @service_call.class.human_attribute_name(:work_status) %></strong></td>
        <td>
          <span class="<%= StylingService.instance.get_style("service_call.states.work_status.#{@service_call.work_status_name}") %>" id="service_call_work_status">
          <h3><%= @service_call.human_work_status_name %></h3>
          </span>
        </td>
      </tr>
      <% unless @service_call.instance_of?(TransferredServiceCall) && @service_call.payment_na? %>
          <tr>
            <td><strong><%= @service_call.class.human_attribute_name(:billing_status) %></strong></td>
            <td>
              <h3><span class="<%= style("service_call.states.billing_status.#{@service_call.billing_status_name}") %>" id="service_call_billing_status">
                  <%= @service_call.human_billing_status_name %>
              </span></h3>
            </td>
          </tr>
      <% end %>

      </tbody>
    </table>


  </li>

  <% unless @service_call.subcon_na? %>
      <li>
        <table class="table table-striped table-condensed table-sbcx">
          <tbody>
          <tr>
            <td><strong><%= @service_call.class.human_attribute_name(:subcontractor_status) %></strong></td>
            <td class="show_more_button">
              <button class="btn btn-mini btn-primary" type="button" id="show_subco_statuses" data-toggle="collapse" data-target="#subco_statuses">
                <%= @service_call.human_subcontractor_status_name %>
                <i class="icon-chevron-down icon-white"></i>
              </button>
              <!--<#%= button_tag t('general.general.show_details'), :class => 'btn btn-mini btn-primary', id: 'show_subco_statuses', data: { toggle: "collapse", target: "#subco_statuses" } %>-->
            </td>
          </tr>
          </tbody>
        </table>
      </li>
      <li>
        <div class="collapse" id="subco_statuses">
          <table class="table table-striped table-condensed table-sbcx">
            <tbody>

            <tr>
              <td><%= @service_call.class.human_attribute_name(:subcontractor) %></td>
              <td>
                  <span class="<%= style("service_call.states.subcontractor_status.#{@service_call.subcontractor_status_name}") %>" id="service_call_subcontractor_name">
                  <h3><%= link_to(@service_call.subcontractor.try(:name), affiliate_path(@service_call.subcontractor)) if @service_call.subcontractor.present? %></h3>
                  </span>
              </td>
            </tr>
            <%= render 'service_calls/transfer_props/subcon_agreement_props' %>
            <tr>
              <td><%= @service_call.class.human_attribute_name(:subcon_agreement) %></td>
              <td>
                 <span class="status_grey">
                 <h3><%= link_to truncate("#{@service_call.subcon_agreement.try(:name)}:#{@service_call.subcon_agreement.try(:id)}", length: 15), agreement_path(@service_call.subcon_agreement), title: "#{@service_call.subcon_agreement.try(:name)}:#{@service_call.subcon_agreement.try(:id)}" if @service_call.subcontractor.present? %>
                 </h3></span>

              </td>
            </tr>

            <tr>
              <td> <%= @service_call.class.human_attribute_name(:subcontractor_status) %></td>
              <td>
                  <span class="<%= style("service_call.states.subcontractor_status.#{@service_call.subcontractor_status_name}") %>" id="service_call_subcontractor_status">
                  <h3><%= @service_call.human_subcontractor_status_name %></h3>
                  </span>
              </td>
            </tr>

            </tbody>
          </table>
        </div>
      </li>
  <% end %>

  <% unless @service_call.class == MyServiceCall %>
      <li>
        <table class="table table-striped table-condensed table-sbcx">
          <tbody>
          <tr>
            <td><strong><%= @service_call.class.human_attribute_name(:provider_status) %></strong></td>
            <td class="show_more_button">
              <!--<#%= button_tag t('general.general.show_details'), :class => 'btn btn-mini btn-primary', id: 'show_prov_statuses', data: { toggle: "collapse", target: "#prov_statuses" } %>-->
              <button class="btn btn-mini btn-primary" type="button" id="show_prov_statuses" data-toggle="collapse" data-target="#prov_statuses">
                <%= @service_call.human_provider_status_name %>
                <i class="icon-chevron-down icon-white"></i>
              </button>

            </td>
          </tr>
          </tbody>
        </table>
      </li>
      <li>
        <div class="collapse" id="prov_statuses">
          <table class="table table-striped table-condensed table-sbcx">
            <tbody>
            <tr>
              <td><%= @service_call.class.human_attribute_name(:provider) %></td>
              <td>
                  <span class="<%= style("service_call.states.provider_status.#{@service_call.provider_status_name}") %>" id="service_call_provider_name">
                  <h3><%= link_to @service_call.provider.try(:name), affiliate_path(@service_call.provider.id) %></h3>
                  </span>
              </td>
            </tr>
            <%= render 'service_calls/transfer_props/prov_agreement_props' %>
            <tr>
              <td><%= @service_call.class.human_attribute_name(:provider_agreement) %></td>
              <td>
                  <span class="status_grey">
                 <h3><%= link_to truncate("#{@service_call.provider_agreement.try(:name)}:#{@service_call.provider_agreement.try(:id)}", length: 15), agreement_path(@service_call.provider_agreement), title: "#{@service_call.provider_agreement.try(:name)}:#{@service_call.provider_agreement.try(:id)}" %>
                 </h3></span>
              </td>
            </tr>
            <tr>
              <td> <%= @service_call.class.human_attribute_name(:provider_status) %></td>
              <td>
                  <span class="<%= style("service_call.states.provider_status.#{@service_call.provider_status_name}") %>" id="service_call_provider_status">
                      <h3><%= @service_call.human_provider_status_name %></h3>
                  </span>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </li>
  <% end %>

</ul>