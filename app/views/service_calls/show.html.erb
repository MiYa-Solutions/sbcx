<div class="well">
  <%= simple_form_for @service_call, as: :service_call, url: service_call_url(@service_call), :html => { :class => 'form-horizontal' }, :remote => true do |f| %>

<div class="row-fluid">


  <div class="no_margins">
      <div class="span4" id="job_statuses_actions">

     <ul class="unstyled" id="block_job_statuses_actions">
       <li>
            <div class= "smart_label">
              <ul>
                <li><h1>Job Status:</h1> </li>
                <li></li>
              </ul>
            </div>
       </li>
       <li>
                 <table class="table table-striped table-condensed table-sbcx">
                      <tbody>
                        <% if ! @service_call.started_on_text.blank? %>
                            <tr>
                              <td>Started at:</td>
                              <td>
                                  <span class="status_label_success">
                                  <badge><%= @service_call.started_on_text %></badge>
                                  </span>
                              </td>
                            </tr>
                        <% end %>
                            <tr>
                              <td>Status:</td>
                              <td>
                                      <span class="status_label">
                                      <badge><%= @service_call.human_status_name %></badge>
                                      </span>
                              </td>
                            </tr>
                            <tr>
                              <td>Subcontractor:</td>
                              <td>
                                      <span class="status_label">
                                      <badge><%= @service_call.human_subcontractor_status_name %></badge>
                                      </span>
                              </td>
                            </tr>
                                <% if ! @service_call.completed_on_text.blank? %>
                                    <tr>
                                      <td>Completed at:</td>
                                      <td>
                                              <span class="status_label">
                                              <badge><%= @service_call.completed_on_text %></badge>
                                              </span>
                                      </td>
                                    </tr>
                                <% end %>
                            <tr>
                                  <td>Billing Status:</td>
                                  <td>
                                              <span class="status_label">
                                              <badge><%= @service_call.human_billing_status_name %></badge>
                                              </span>
                                  </td>
                                </tr>
                        </tbody>
                 </table>
       </li>
     </ul>


      </div>
  </div>

    <div class="span8" id="job_details">

      <div class="smart_label"  >
            <ul>
              <li><h1>Job Name:</h1> </li>
              <li></li>
              <!--<#% if ! @service_call.started_on_text.blank? %>-->
                  <!--<li>-->
                    <!--<span>Completed on:</span>-->
                    <!--<#%= f.text_field :completed_on_text, class: "datepicker input-medium", placeholder: 'Click to set date' %>-->
                  <!--</li>-->
                    <!--&lt;!&ndash;<span class="help-inline">Click to set date</span>&ndash;&gt;-->
                <!--<#% end %>-->
            <!--</li>-->
            </ul>
          </div>
      <br>

      <div class="row-fluid">
          <div class="span6">
            <ul class="unstyled list_service_calls" >

                <% if ! @service_call.started_on_text.blank? %>
                  <li>
                    <div class="control-group select required">
                      <label class="select optional control-label" for="completed_on_text">Completed On:</label>
                      <div class="controls">
                         <%= f.text_field :completed_on_text, class: "datepicker", placeholder: 'Click to set date' %>
                      </div>
                    </div>
                  </li>
              <% end %>

              <li>
                      <div id="customer_wrapper">
                        <%= f.association :customer, collection: current_user.organization.customers, value: f.object.customer %>
                      </div>
              </li>
              <li class="list_service_calls" >
                    <address>
                      <strong>Twitter, Inc.</strong><button class="btn btn-info btn-mini" data-toggle="collapse" data-target="#show_customer_in_service_call" id="show_customer_from_service_call">
                      Edit</button><br>
                      795 Folsom Ave, Suite 600<br>
                      San Francisco, CA 94107<br>
                      Phone: (123) 456-7890
                    </address><br>
               </li>
              <li>
                <address>
                   <div id="show_customer_in_service_call" class="collapse">
                            dddd
                    </div>
                </address>
               </li>
              <li>
                  <%= f.association :subcontractor, collection: ([current_user.organization.becomes(Subcontractor)] + current_user.organization.subcontractors), value: f.object.subcontractor, :include_blank => "Me" %>
              </li>
              <li>
                  <%= f.association :technician, collection: current_user.organization.users, value: f.object.customer %>
              </li>
              <li>
                  <%= f.association :provider, collection: ([current_user.organization.becomes(Provider)] + current_user.organization.providers), value: f.object.provider, :include_blank => "Me" %>
              </li>
            </ul>

            <div class="form-actions_in_service_call">
                <div class="form-actions">
                  <%= link_to "Back", service_calls_path, class: "btn btn-large btn-info" %>
                  <%= f.submit "Save Changes", class: "btn btn-large btn-primary", id: 'service_call_save_btn' %>
                </div>
            </div>

         </div>

          <div class="span6" id="job_notes">

            <div class="miya_note_area string mandatory">
              <%= f.input :notes %>
            </div>

          </div>

      </div>
    </div>

</div>



<!--end of status & Job details section-->
<% end %>

<div class="row-fluid">
    <div class="no_margins">
      <div class="span4">
        <ul class="unstyled">
          <li>
            <div class= "smart_label">
                  <ul>
                    <li><h1>Actions:</h1> </li>
                    <li></li>
                  </ul>
            </div>
          </li>
          <li><br></li>
        <li>
            <div class= "action_buttons_service_call">
              <p>
                         <%= event_list(@service_call)%>
              </p>
            </div>
         </li>
      </ul>
    </div>
  </div>
</div>




<div class="row-fluid">
  <div class="no_margins">
    <div class= "smart_label">
      <ul>
        <li><h1>Job History:</h1> </li>
        <li></li>
      </ul>
    </div>
  </div>
</div>


  <!--end of well  -->
</div>









  <h1><%= @service_call.customer.name %></h1>

<% @service_call.attributes.map.each do |key, value| %>
    <p>
      <strong><%= ServiceCall.human_attribute_name(key) %></strong>

      <% case key %>
      <% when "status" %>
          <span class="label label-success" id="service_call_status"><%= @service_call.human_status_name %></span>
      <% when "subcontractor_status" %>
          <span class="label label-info" id="service_call_subcontractor_status"><%= @service_call.human_subcontractor_status_name %></span>
      <% when "billing_status" %>
          <span class="label label-info" id="service_call_billing_status"><%= @service_call.human_billing_status_name %></span>
      <% when "started_on" %>
          <span class="label label-info" id="service_call_started_on_text"><%= @service_call.started_on_text %></span>
      <% when "completed_on" %>
          <span class="label label-info" id="service_call_completed_on_text"><%= @service_call.completed_on_text %></span>

      <% else %>
          <%= value %>
      <% end %>
    </p>


<% end %>


===============================================================
<p>
  <strong>Customer:</strong>
  <%= @service_call.customer.try(:name) %>
</p>
<p>
  <strong>Organization:</strong>
  <%= @service_call.organization.try(:name) %>
</p>
<p>
  <strong>Subcontractor</strong>
  <%= @service_call.subcontractor.try(:name) %>
</p>
<p>
  <strong><%= ServiceCall.human_attribute_name(:provider) %></strong>
  <span id="provider"><%= @service_call.provider.try(:name) %></span>
</p>
<p>
  <strong>Technician</strong>
  <%= @service_call.technician.try(:name) %>
</p>

<p>
  <strong><%= ServiceCall.human_attribute_name(:creator) %> </strong>
  <%= @service_call.creator.try(:name) %>
</p>

<p>
  <strong><%= ServiceCall.human_attribute_name(:updater) %> </strong>
  <%= @service_call.updater.try(:name) %>
</p>

<p>
  <%= link_to "Edit", edit_service_call_path(@service_call.becomes(ServiceCall)) %> |
  <%= link_to "Destroy", @service_call.becomes(ServiceCall), :confirm => 'Are you sure?', :method => :delete %> |
  <%= link_to "View All", service_calls_path %>
</p>


<%= event_list(@service_call) %>

<table class="table table-striped">
  <thead>

  </thead>
  <tbody>
  <% @service_call.events.each do |event| %>
      <tr>
        <td>
          <%= event.description  %>
        </td>
        <td>
          <%= event.name  %>
        </td>

      </tr>
  <% end %>
  </tbody>
</table>



<table class="table table-striped">
  <thead>
  <tr>
    <% Event.attribute_names.each do |name| %>
        <th><%= name.titleize %></th>
    <% end %>
  </tr>
  </thead>
  <tbody>
  <% @service_call.events.each do |event| %>
      <tr>
        <% event.attributes.each do |key, value| %>
            <td><%= value %></td>
        <% end %>
      </tr>
  <% end %>
  </tbody>
</table>
