<div id="state_code_wrapper">
  <% parent_region ||= params[:parent_region] %>
  <% country = Carmen::Country.coded(parent_region) %>

  <% if country.nil? %>
      <%= subregion_select(object.class.to_s.downcase, :state, 'US') %>
  <% elsif country.subregions? %>
      <%= subregion_select(object.class.to_s.downcase, :state, parent_region) %>
  <% else %>
      <%= text_field(object.class.to_s.downcase, :state) %>
  <% end %>
</div>